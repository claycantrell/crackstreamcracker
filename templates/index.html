<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stream Iframe Extractor - Educational Tool</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <!-- Main container: Centers content and provides consistent spacing -->
    <div class="container">
        <!-- Header Section -->
        <div class="header">
            <h1>Stream Iframe Extractor</h1>
            <p>Educational tool for analyzing embedded video players</p>
        </div>
        
        <!-- ================================================================
             LEGAL CONSENT SECTION
             ================================================================
             Why required? Legal protection against misuse
             - Click-through agreement (enforceable contract)
             - Consent timestamp logged in backend
             - Gates functionality behind explicit acceptance
             ================================================================ -->
        <div style="background: #ffffff; padding: 16px 18px; margin: 20px 0; border-radius: 12px; border: 2px solid #ff3b30; box-shadow: 0 2px 8px rgba(255, 59, 48, 0.1);">
            <h3 style="margin-top: 0; font-size: 17px; font-weight: 600; color: #ff3b30; margin-bottom: 10px;">⚖️ Legal Terms & Acceptable Use</h3>
            <p style="font-size: 14px; margin: 10px 0; line-height: 1.5; color: #1d1d1f;">
                <strong>By clicking "I Agree—Analyze Page", you represent and warrant:</strong>
            </p>
            <ol style="font-size: 13px; line-height: 1.6; margin: 10px 0 10px 20px; color: #1d1d1f;">
                <li style="margin-bottom: 6px;"><strong>You own the content you analyze</strong> or have explicit permission from the rights holder.</li>
                <li style="margin-bottom: 6px;"><strong>You will not use this tool</strong> to access, retrieve, copy, or expose content protected by:
                    <ul style="margin: 4px 0 0 20px; font-size: 12px;">
                        <li>Paywalls, logins, authentication tokens, or session controls</li>
                        <li>DRM (Digital Rights Management) systems</li>
                        <li>X-Frame-Options, CSP frame-ancestors, or other security headers</li>
                        <li>Technical protection measures or access controls</li>
            </ul>
                </li>
                <li style="margin-bottom: 6px;"><strong>You will not bypass</strong> technical measures or violate any website's Terms of Service.</li>
                <li style="margin-bottom: 6px;"><strong>You acknowledge</strong> this tool uses server-side rendering to extract iframe URLs from publicly accessible pages. We do not host, store, cache, or redistribute third-party content, media files, or copyrighted material.</li>
                <li style="margin-bottom: 6px;"><strong>You agree</strong> we may disable your access for suspected abuse or policy violations.</li>
            </ol>
            <p style="font-size: 13px; margin: 12px 0; line-height: 1.5; color: #1d1d1f; background: #f5f5f7; padding: 10px; border-radius: 8px;">
                <strong>Prohibited Uses:</strong> Circumvention of access controls; scraping personal data; use on paywalled/login-gated pages; copyright infringement; violations of DMCA, CFAA, or applicable law.
            </p>
            <p style="font-size: 12px; margin: 10px 0 0 0; color: #86868b; line-height: 1.5;">
                <strong>Limitation of Liability:</strong> Use at your own risk. We disclaim all warranties and are not liable for misuse, damages, or third-party claims. This is provided as-is with no support or warranty of any kind.
            </p>
        </div>
        
        <!-- ================================================================
             INPUT SECTION (User interaction)
             ================================================================ -->
        <div class="input-section">
            <div class="input-group">
                <!-- Text input: Captures URL to analyze -->
                <!-- id="urlInput": JavaScript accesses via getElementById() -->
                <input type="text" id="urlInput" placeholder="Enter webpage URL to analyze embedded players..." value="">
                
                <!-- Submit button: Initially disabled until consent given -->
                <!-- onclick="extractStream()": Calls JavaScript function -->
                <button class="btn" id="analyzeBtn" onclick="extractStream()" disabled style="opacity: 0.5; cursor: not-allowed;">I Agree—Analyze Page</button>
            </div>
            
            <!-- Required Consent Checkbox: Gates functionality -->
            <div style="margin-top: 14px; padding: 12px; background: #f5f5f7; border-radius: 10px; border: 1.5px solid #d2d2d7;">
                <label style="display: flex; align-items: flex-start; cursor: pointer; font-size: 14px; color: #1d1d1f; line-height: 1.5;">
                    <input type="checkbox" id="consentCheckbox" onchange="handleConsentChange()" style="margin-right: 10px; margin-top: 2px; width: 18px; height: 18px; cursor: pointer; flex-shrink: 0;">
                    <span><strong>I confirm</strong> I own the content or have permission, and I will not use this tool to bypass access controls, violate Terms of Service, or infringe copyrights. I have read and agree to the Legal Terms above.</span>
                </label>
            </div>
            
            <p style="color: #86868b; margin-top: 10px; font-size: 14px;">
                Automatically detects iframe elements and embedded video players for technical analysis
            </p>
        </div>
        
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Analyzing page structure...</p>
        </div>
        
        <div class="error" id="error"></div>
        
        <div class="player-section" id="playerSection">
            <div style="margin-bottom: 16px;">
                <h2 id="streamTitle" style="margin: 0;">Stream Viewer</h2>
            </div>
            
            <div class="stream-selector" id="streamSelector" style="display: none;">
                <label for="streamSelect">Select Stream:</label>
                <select id="streamSelect" onchange="changeStream()">
                    <option value="">Choose a stream...</option>
                </select>
            </div>
            
            <!-- Stream URL Controls Card -->
            <div id="streamUrlCard" style="display: none; background: #f5f5f7; padding: 14px; margin-bottom: 16px; border-radius: 12px; border: 1px solid #d2d2d7;">
                <!-- URL controls will be inserted here -->
            </div>
            
            <!-- Ad Warning Card -->
            <div id="adWarningCard" style="display: none; background: #fff; color: #1d1d1f; padding: 14px; margin-bottom: 16px; border-radius: 12px; border: 2px solid #ff9500; box-shadow: 0 2px 8px rgba(255, 149, 0, 0.1);">
                <strong style="color: #ff9500; font-size: 16px;">Notice about third-party ads</strong><br>
                <p style="margin: 10px 0 0 0; line-height: 1.5; font-size: 14px;">This stream's source page may include advertising controlled by the publisher. Ads shown inside the embedded page can't be modified from within this tool.</p>
            </div>
            
            <!-- Embedding Blocked Warning Card -->
            <div id="blockedWarningCard" style="display: none; background: #fff; color: #1d1d1f; padding: 14px; margin-bottom: 16px; border-radius: 12px; border: 2px solid #ff3b30; box-shadow: 0 2px 8px rgba(255, 59, 48, 0.1);">
                <!-- Warning content will be inserted here -->
            </div>
            
            <div class="player-container" id="playerContainer">
                <!-- Stream will be loaded here -->
            </div>
            
            <div class="info" id="info">
                <h3>Stream Information</h3>
                <ul id="infoList"></ul>
            </div>
            
            <!-- Real-Time Block Monitor -->
            <div id="blockMonitor" style="margin-top: 16px; background: #ffffff; border-radius: 12px; padding: 14px; border: 1.5px solid #d2d2d7; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06); display: none;">
                <div style="display: flex; flex-direction: column; gap: 10px; margin-bottom: 12px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <h3 style="margin: 0; color: #1d1d1f; font-size: 17px; font-weight: 600;">Blocked Threats</h3>
                        <span id="blockCount" style="background: #ff3b30; color: white; padding: 4px 12px; border-radius: 12px; font-size: 14px; font-weight: 600;">0</span>
                    </div>
                    <button onclick="clearBlockMonitor()" style="width: 100%; padding: 8px 14px; background: #007aff; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 500; transition: all 0.2s; -webkit-tap-highlight-color: transparent;">Clear</button>
                </div>
                <div id="blockList" style="max-height: 200px; overflow-y: auto; background: #f5f5f7; padding: 12px; border-radius: 8px; font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace; font-size: 11px;">
                    <div style="color: #86868b;">Monitoring for blocked requests...</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- External JavaScript: url_for() generates correct path -->
    <!-- Loaded at end of <body> for faster initial page render -->
    <!-- Why? HTML parses top-to-bottom; JS at end = DOM ready when script runs -->
    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>

